#!/usr/bin/env ruby
# encoding: utf-8

require "digest"
require "set"
require_relative "../lib/project_pull_mover"

include ProjectPullMover::Utils

options = ProjectPullMover::Options.new(file: __FILE__, proj_items_limit: 500, pull_fields_per_query: 7)
options.parse
exit 1 unless options.valid?

gh_cli = ProjectPullMover::GhCli.new(options)
data_loader = ProjectPullMover::DataLoader.new(gh_cli: gh_cli, options: options)

gh_cli.check_auth_status unless options.quiet_mode?

result = data_loader.load
unless result.success?
  output_error_message(result.error_message)
  exit 1
end

ProjectPullMover::PullRequestMover.run(data: result, options: options)
